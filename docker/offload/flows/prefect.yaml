# Prefect deployment configuration for Iceberg offload pipeline
name: k2-iceberg-offload
prefect-version: 3.6.12

# Pull step (code is mounted at /opt/prefect/flows in worker container)
pull:
  - prefect.deployments.steps.set_working_directory:
      directory: /opt/prefect/flows

# Deployments
deployments:
  - name: iceberg-offload-15min
    version: "3.0.0"
    tags:
      - iceberg
      - offload
      - production
      - phase-5
    description: "ClickHouse â†’ Iceberg offload pipeline (Bronze layer, runs every 15 minutes)"
    entrypoint: iceberg_offload_flow.py:iceberg_offload_main
    work_pool:
      name: iceberg-offload
      work_queue_name: default
    schedule:
      cron: "*/15 * * * *"
      timezone: "UTC"
